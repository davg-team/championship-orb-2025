# OpenBao - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ `docker-compose up -d`:

1. ‚úÖ OpenBao –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
2. ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è 5 unseal keys –∏ root token
3. ‚úÖ –ö–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volume `openbao_keys`
4. ‚úÖ OpenBao –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
5. ‚úÖ –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ù–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!** üéâ

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### –ü–æ–ª—É—á–∏—Ç—å Root Token

```bash
chmod +x get-root-token.sh
./get-root-token.sh
```

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç token –¥–ª—è –≤—Ö–æ–¥–∞ –≤ UI: https://orencode.davg-team.ru/vault/

### –ü–æ–ª—É—á–∏—Ç—å Unseal Keys

```bash
chmod +x get-unseal-keys.sh
./get-unseal-keys.sh
```

–≠—Ç–∏ –∫–ª—é—á–∏ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤–∞—Ä–∏–π–Ω–æ–π —Ä—É—á–Ω–æ–π —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

### –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –∫–ª—é—á–µ–π (–í–ê–ñ–ù–û!)

```bash
chmod +x backup-keys.sh
./backup-keys.sh
```

–§–∞–π–ª –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ `backups/openbao-keys-TIMESTAMP.json`

**‚ö†Ô∏è –•–†–ê–ù–ò–¢–ï –ë–≠–ö–ê–ü –í –ë–ï–ó–û–ü–ê–°–ù–û–ú –ú–ï–°–¢–ï!**

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
openbao/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.hcl          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è OpenBao
‚îú‚îÄ‚îÄ Dockerfile              # –ö–∞—Å—Ç–æ–º–Ω—ã–π –æ–±—Ä–∞–∑ —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π
‚îú‚îÄ‚îÄ entrypoint.sh           # –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ get-root-token.sh       # –ü–æ–ª—É—á–∏—Ç—å root token
‚îú‚îÄ‚îÄ get-unseal-keys.sh      # –ü–æ–ª—É—á–∏—Ç—å unseal keys
‚îú‚îÄ‚îÄ backup-keys.sh          # –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –∫–ª—é—á–µ–π
‚îú‚îÄ‚îÄ unseal.sh               # –£—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–∫—Ä–∏–ø—Ç (–Ω–µ –Ω—É–∂–µ–Ω)
‚îî‚îÄ‚îÄ backups/                # –ë—ç–∫–∞–ø—ã –∫–ª—é—á–µ–π (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

## –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–ª—é—á–∏

–ö–ª—é—á–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Docker volumes:

- `openbao_data` - –¥–∞–Ω–Ω—ã–µ OpenBao (—Å–µ–∫—Ä–µ—Ç—ã, –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ —Ç.–¥.)
- `openbao_keys` - unseal keys –∏ root token
- `openbao_logs` - –ª–æ–≥–∏

Volumes –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ `docker-compose down`, —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `docker-compose down -v`.

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚ö†Ô∏è –í–ê–ñ–ù–û –¥–ª—è production:

1. **–°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –∫–ª—é—á–µ–π:**
   ```bash
   ./backup-keys.sh
   ```
   –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ (password manager, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)

2. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É:**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ VPN –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ OpenBao
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–∞—Ä–æ–ª–∏

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   ```bash
   docker-compose logs -f openbao
   ```

4. **–†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤:**
   - Root token —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

## Troubleshooting

### OpenBao –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
docker-compose logs openbao
```

–†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é:
```bash
./get-unseal-keys.sh
docker exec -it openbao bao -address http://127.0.0.1:8200 operator unseal
# –í–≤–µ–¥–∏—Ç–µ 3 –ª—é–±—ã—Ö –∫–ª—é—á–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
```

### –ü–æ—Ç–µ—Ä—è–Ω Root Token

```bash
./get-root-token.sh
```

### –ü–æ—Ç–µ—Ä—è–Ω—ã Unseal Keys

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –±—ç–∫–∞–ø:
```bash
cat backups/openbao-keys-*.json
```

–ï—Å–ª–∏ –Ω–µ—Ç –±—ç–∫–∞–ø–∞ –∏ OpenBao –∑–∞–ø–µ—á–∞—Ç–∞–Ω - **–¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ**. 
–ü—Ä–∏–¥–µ—Ç—Å—è –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å (–≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã):
```bash
docker-compose down -v
docker-compose up -d
```

## –†—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–û–±—ã—á–Ω–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –Ω–æ –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å volume —Å –∫–ª—é—á–∞–º–∏
docker-compose down
docker volume rm championship-orb-2025-private_openbao_keys

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker-compose up -d
```

OpenBao –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ —Å –Ω–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏.
