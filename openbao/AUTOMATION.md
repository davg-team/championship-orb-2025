# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è OpenBao - –†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è OpenBao. –¢–µ–ø–µ—Ä—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã: `docker-compose up -d`

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –°–æ–∑–¥–∞–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π Docker –æ–±—Ä–∞–∑ –¥–ª—è OpenBao

**–§–∞–π–ª:** `openbao/Dockerfile`
- –ë–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º –æ–±—Ä–∞–∑–µ `openbao/openbao:latest`
- –î–æ–±–∞–≤–ª–µ–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (bash, grep, sed, coreutils)
- –í—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π entrypoint —Å–∫—Ä–∏–ø—Ç

### 2. –°–æ–∑–¥–∞–Ω entrypoint —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `openbao/entrypoint.sh`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç OpenBao —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ OpenBao (—á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ `.initialized`)
- ‚úÖ –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç OpenBao (5 unseal keys, –ø–æ—Ä–æ–≥ 3)
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–ª—é—á–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ –≤ `/openbao/keys/unseal-keys.json`
  - –í—ã–≤–æ–¥–∏—Ç root token –≤ –ª–æ–≥–∏
  - –°–æ–∑–¥–∞–µ—Ç —Ñ–ª–∞–≥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç OpenBao –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ:
  - –ò–∑–≤–ª–µ–∫–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 3 unseal keys –∏–∑ JSON
  - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏—Ö –¥–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∏ –¥–µ—Ä–∂–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å –∂–∏–≤—ã–º

### 3. –û–±–Ω–æ–≤–ª–µ–Ω docker-compose.yml

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å–µ openbao:**
```yaml
- image: openbao/openbao:latest          # –ë—ã–ª–æ
+ build: context: ./openbao              # –°—Ç–∞–ª–æ (–∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–±—Ä–∞–∑)

- command: server -dev                   # –£–±—Ä–∞–Ω dev-—Ä–µ–∂–∏–º
+ entrypoint —á–µ—Ä–µ–∑ Dockerfile            # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π entrypoint

+ volumes:
+   - openbao_keys:/openbao/keys        # –ù–æ–≤—ã–π volume –¥–ª—è –∫–ª—é—á–µ–π

+ restart: unless-stopped                # –ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
+ start_period: 30s                      # –£–≤–µ–ª–∏—á–µ–Ω–æ –≤—Ä–µ–º—è –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

**–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π volume:**
```yaml
volumes:
  openbao_keys:  # –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è unseal keys –∏ root token
```

### 4. –°–æ–∑–¥–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–°–∫—Ä–∏–ø—Ç—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `openbao/`:**

1. **`get-root-token.sh`** - –ü–æ–ª—É—á–∏—Ç—å root token
   ```bash
   ./get-root-token.sh
   ```

2. **`get-unseal-keys.sh`** - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ unseal keys
   ```bash
   ./get-unseal-keys.sh
   ```

3. **`backup-keys.sh`** - –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –∫–ª—é—á–µ–π
   ```bash
   ./backup-keys.sh
   ```
   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –≤ `backups/openbao-keys-TIMESTAMP.json`

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `openbao/README.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- `DEPLOYMENT.md` - –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å —É—á–µ—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- `README.md` - –û–±–Ω–æ–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞"

**–û–±–Ω–æ–≤–ª–µ–Ω `.gitignore`:**
```gitignore
# –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ –∫–ª—é—á–µ–π
unseal-keys.json
backups/
keys/
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—Ö–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç)

```bash
docker-compose up -d
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
1. Docker —Å–æ–±–∏—Ä–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –æ–±—Ä–∞–∑ OpenBao (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–æ–±—Ä–∞–Ω)
2. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å entrypoint.sh
3. OpenBao –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (—Å–æ–∑–¥–∞—é—Ç—Å—è –∫–ª—é—á–∏)
4. –ö–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volume `openbao_keys`
5. OpenBao –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
6. Root token –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ª–æ–≥–∏: `docker-compose logs openbao`

### –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏

```bash
docker-compose up -d
# –∏–ª–∏
docker-compose restart openbao
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. OpenBao –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
2. Entrypoint –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥ `.initialized`
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç unseal keys –∏–∑ volume
4. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç OpenBao
5. –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **Zero manual configuration** - –Ω–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
‚úÖ **Persistent storage** - –∫–ª—é—á–∏ –∏ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Docker volumes
‚úÖ **Auto-unseal** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
‚úÖ **Secure by default** - –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ volume, –Ω–µ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —Ö–æ—Å—Ç–∞
‚úÖ **Easy backup** - –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ç–∫–∞–ø–∞ –∫–ª—é—á–µ–π
‚úÖ **Production-ready** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–Ω–µ dev —Ä–µ–∂–∏–º)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–ª—é—á–∏

- **–í Docker volume `openbao_keys`** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –ö–ª—é—á–∏ –ù–ï —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ —Ö–æ—Å—Ç–∞ (–µ—Å–ª–∏ –Ω–µ –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø)
- Volume –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ `docker-compose down`
- –£–¥–∞–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `docker-compose down -v` (—è–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ volumes)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. **–°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –∫–ª—é—á–µ–π —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
   ```bash
   cd openbao
   ./backup-keys.sh
   ```
   –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ (password manager, encrypted storage)

2. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É:**
   - Firewall
   - VPN
   - –°–µ—Ç–µ–≤–∞—è –∏–∑–æ–ª—è—Ü–∏—è

3. **–†–µ–≥—É–ª—è—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   ```bash
   docker-compose logs -f openbao
   ```

4. **–†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤:**
   - Root token –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–ï—Å–ª–∏ —É –≤–∞—Å –±—ã–ª–∞ —Ä—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# 2. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ volumes –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å —Å –Ω—É–ª—è
docker volume rm championship-orb-2025-private_openbao_data
docker volume rm championship-orb-2025-private_openbao_logs

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
docker-compose up -d

# 4. –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π root token
cd openbao
./get-root-token.sh

# 5. –°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø –∫–ª—é—á–µ–π
./backup-keys.sh
```

## Troubleshooting

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

```bash
docker-compose logs openbao | grep "initialized"
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å root token –≤ –ª–æ–≥–∞—Ö

```bash
docker-compose logs openbao | grep "Root Token"
```

### –í—Ä—É—á–Ω—É—é –∏–∑–≤–ª–µ—á—å –∫–ª—é—á–∏ –∏–∑ volume

```bash
docker exec openbao cat /openbao/keys/unseal-keys.json
```

### –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å OpenBao

```bash
docker-compose down
docker volume rm championship-orb-2025-private_openbao_keys
docker volume rm championship-orb-2025-private_openbao_data
docker-compose up -d
```

## –ò—Ç–æ–≥

**–î–æ:**
```bash
docker-compose up -d
docker exec -it openbao bao -address http://127.0.0.1:8200 operator init
# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–∏ –≤—Ä—É—á–Ω—É—é
docker exec -it openbao bao -address http://127.0.0.1:8200 operator unseal  # x3
# –ü—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Ä—É—á–Ω—É—é
```

**–ü–æ—Å–ª–µ:**
```bash
docker-compose up -d
# –ì–æ—Ç–æ–≤–æ! üéâ
```

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
