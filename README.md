# **SecretManager - Система управления корпоративными секретами**

## **Оглавление**

- [Описание проекта](#описание-проекта)
- [О мероприятии](#о-мероприятии)
- [Техническое описание](#техническое-описание)
- [Архитектура решения](#архитектура-решения)
- [Технологический стек](#технологический-стек)
- [Развёртывание](#развёртывание)
- [Демонстрация](#демонстрация)
- [Состав команды](#состав-команды)
- [Лицензия](#лицензия)

## **Описание проекта**

Проект представляет собой систему управления корпоративными секретами, где сотрудники могут запрашивать доступ к паролям баз данных, API ключам и другим конфиденциальным данным через веб-интерфейс, получать одобрение от администраторов и использовать их через локальный клиент.

## **О мероприятии**

Данный проект был разработан в рамках **Чемпионата Оренбургской области по спортивному программированию «ОренКод-2025»**.  

- **Дисциплина**: Программирование продуктовое  
- **Команда**: davg  
- **Даты проведения**: с 3 октября по 6 октября 2025 года

---

## **Техническое описание**

### Проблема

В корпоративной среде управление доступом к секретам (пароли баз данных, API ключи, сертификаты) часто происходит хаотично и небезопасно. Отсутствие централизованного контроля приводит к рискам утечек и сложностям в аудите доступа.

### Цель проекта

Создать современную систему управления корпоративными секретами с веб-интерфейсом для запросов доступа, системой согласования и локальным клиентом для безопасного использования секретов.

### Основной функционал

- Веб-интерфейс для запроса доступа к секретам
- Система согласования запросов администраторами
- Безопасное хранение секретов в OpenBao
- Локальный клиент для получения и использования секретов
- Аудит и логирование всех операций с секретами

---

## **Архитектура решения**

Система построена на микросервисной архитектуре с разделением на независимые компоненты.

### Основные компоненты

```
┌─────────────────┐     ┌─────────────────┐
│   Web Client    │     │ Desktop Client  │
│   (React)       │     │    (Tauri)      │
└────────┬────────┘     └────────┬────────┘
         │                       │
         └───────────┬───────────┘
                     │
              ┌──────▼───────┐
              │    Nginx     │ ← SSL/TLS
              │ (Reverse     │
              │   Proxy)     │
              └──────┬───────┘
                     │
         ┌───────────┼───────────┐
         │           │           │
    ┌────▼────┐ ┌───▼────┐ ┌───▼─────┐
    │Backend  │ │Backend │ │OpenBao  │
    │  Apps   │ │Notific │ │(Secrets)│
    └────┬────┘ └───┬────┘ └─────────┘
         │          │
    ┌────▼──────────▼────┐
    │    PostgreSQL      │
    └────────────────────┘
              │
         ┌────▼─────┐
         │RabbitMQ  │
         │ (Queue)  │
         └──────────┘
```

**Компоненты:**

- **Веб-интерфейс** (React + TypeScript) — запрос и управление доступом к секретам
- **Desktop клиент** (Tauri) — безопасное локальное использование секретов
- **Backend Applications** (Go) — управление приложениями и доступами
- **Backend Notifications** (Go) — обработка уведомлений через очередь
- **OpenBao** — защищённое хранилище секретов с автоматической разблокировкой
- **PostgreSQL** — хранение метаданных приложений и пользователей
- **RabbitMQ** — асинхронная обработка уведомлений
- **Nginx** — SSL-терминация и маршрутизация запросов
- **Keycloak** — единая аутентификация (SSO)

---

## **Технологический стек**

### Backend

**Backend Applications** (Управление приложениями и доступами)
- Go 1.24.3, Gin Web Framework
- PostgreSQL 15 + GORM
- JWT аутентификация (golang-jwt/jwt v5)
- Интеграция с OpenBao API

**Backend Notifications** (Сервис уведомлений)
- Go 1.24.6, Gin Web Framework
- PostgreSQL 15 + GORM
- RabbitMQ для асинхронной обработки (amqp091-go)
- Email через Yandex Cloud SMTP

### Frontend

**Web-приложение**
- TypeScript 5.8 + React 18.2
- Vite 7.0, React Router DOM 7.9
- Gravity UI (@gravity-ui/uikit 7.23)
  - Компоненты, формы, date-picker
  - Markdown Editor, ChartKit для визуализации
- Zustand 5.0 для управления состоянием
- SASS для стилизации

**Desktop клиент**
- Frontend: TypeScript 5.8 + React 18.2 + Gravity UI
- Backend: Rust (Tauri 2.0)
- Плагины: autostart, opener, process, shell, tray-icon
- Шифрование: ChaCha20-Poly1305
- Secure Storage: keyring для хранения токенов

### Инфраструктура

- **OpenBao** — хранилище секретов с автоинициализацией
- **Keycloak** — SSO (OAuth2, SAML, OpenID Connect)
- **PostgreSQL 15** — две инстанции (Keycloak + Backend)
- **RabbitMQ 3** — очередь сообщений
- **Nginx** — HTTPS/TLS 1.2/1.3, Let's Encrypt, reverse proxy
- **Docker + Docker Compose** — контейнеризация
- Изолированные сети, persistent volumes, централизованное логирование


## **Развёртывание**

### Требования

- Docker 20.10+
- Docker Compose 2.0+
- Свободные порты: 80, 443, 5433, 8200, 15672

### Быстрый старт

**1. Клонируйте репозиторий:**

```bash
git clone https://github.com/davg-team/championship-orb-2025.git
cd championship-orb-2025
```

**2. Запустите все сервисы:**

```bash
docker-compose up -d
```

**Готово!** 🎉 Система автоматически развернётся и будет доступна через несколько минут.

### Доступ к сервисам

После запуска доступны следующие интерфейсы:

| Сервис | URL | Логин | Пароль |
|--------|-----|-------|--------|
| **Web-интерфейс** | https://orencode.davg-team.ru/ | user@davg-team.ru | user_test_password |
| **Keycloak Admin** | https://orencode.davg-team.ru/auth/ | `admin` | `admin45454545` |
| **OpenBao UI** | https://orencode.davg-team.ru/vault/ | Token¹ | - |
| **RabbitMQ Management** | http://localhost:15672/ | `guest` | `guest` |

¹ *Получите root token командой:*
```bash
docker exec openbao cat /openbao/keys/unseal-keys.json | grep -o '"root_token":"[^"]*' | cut -d'"' -f4
```

### Важные действия после развёртывания

**Создайте бэкап ключей OpenBao:**

```bash
cd openbao
chmod +x backup-keys.sh
./backup-keys.sh
```

Сохраните файл из `openbao/backups/` в безопасном месте — без этих ключей восстановить доступ к секретам будет невозможно.

### Управление

**Просмотр логов:**
```bash
docker-compose logs -f [имя_сервиса]
```

**Перезапуск:**
```bash
docker-compose restart
```

**Остановка:**
```bash
docker-compose down
```

**Проверка статуса:**
```bash
docker-compose ps
```

### Troubleshooting

**Сервисы не запускаются:**
- Проверьте, что все порты свободны: `netstat -tuln | grep -E '80|443|5433|8200|15672'`
- Посмотрите логи проблемного сервиса: `docker-compose logs [имя_сервиса]`

**OpenBao запечатан:**
```bash
# Автоматически разблокируется при перезапуске
docker-compose restart openbao
```

Подробнее: [DEPLOYMENT.md](DEPLOYMENT.md) | [openbao/README.md](openbao/README.md)

---

## **Демонстрация**

🌐 **Живое демо**: [orencode.davg-team.ru](https://orencode.davg-team.ru/)

## **Состав команды**

![Логотип](https://github.com/davg-team/hackathon-2025-orb/raw/refs/heads/main/docs/orb.jpg)

- **Юматов Алексей** |
  **Роль**: Капитан, бэкенд  
  [Telegram](https://t.me/monikre)  

- **Касилов Глеб** |
  **Роль**: Бэкенд  
  [Telegram](https://t.me/helebka)  

- **Колядин Дмитрий** |
  **Роль**: Бэкенд  
  [Telegram](https://t.me/DeveloperDK)  

- **Старикова Варвара** |
  **Роль**: Дизайн  
  [Telegram](https://t.me/vaalkot)  

- **Шевлюк Василий** |
  **Роль**: Фронтенд  
  [Telegram](https://t.me/jlyou)  
  
---

## **Лицензия**

Этот проект лицензирован на условиях [лицензии](LICENSE.md).
